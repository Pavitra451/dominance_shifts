This folder contains the simulation code for the preprint 
"Dominance shifts increase the likelihood of soft selective sweeps". Muralidhar, P., & Veller, C. (2021).
doi: https://doi.org/10.1101/2021.02.22.432386

This file will give a basic overview of the code. For more details, please see the Methods section of the preprint. 

The simulations are divided into "before" and "after" categories.

The "before" simulations simulate the environment in which the focal allele is deleterious. These simulations record a mutation-selection-drift distribution for the focal allele. A single value from the mutation-selection-drift distribution (representing a random generation) is then drawn in each "after" simulation run and provides the starting frequency of the focal allele (and its distribution in homozygotes and heterozygotes) for that simulation run.  

The "after" simulations model the population after an environmental change has occurred and the focal allele is now beneficial. They record the eventual fate of the allele in the population (e.g. does it undergo a selective sweep or is it lost; if it sweeps, how many allele copies are involved; etc.)


Code in folder:

Before_simulations.slim: records the mutation-selection-drift distribution for the focal allele in the "before" environment.
 
Before_mutational_lineages.slim: same as the previous code, but also records information on how many independent mutational lineages are segregating in the population every generation. 

After_simulations: basic simulations that record the fate of the focal allele in the population
after the environmental change has occurred. 

After_mutational_lineages.slim: same as the basic after simulations, but tracks the number of independent mutational lineages as well as the number of allele copies. This code uses the mutation-selection-drift distributions generated by "Before_mutational_lineages.slim" rather than "Before_simulations.slim".

After_recurrent_mutation.slim: allows new mutations to occur after the environmental change 

After_rescue: incorporates population size changes based on mean population fitness, and records population size trajectories for each simulation run.

Details on what parameters are recorded in the "after" simulations are given in more detail in the Methods section of the preprint. 
In the basic "after" simulations, these include the population parameters (N, u, h, s) before 
and after the environmental change, the number of homozygotes and heterozygotes in the population
at the time of the environmental change, a code indicating the outcome after the environmental change
(0 = no standing variation, 1 = hard sweep, 2 = soft sweep, 3 = failed sweep),
and a variety of diversity indices if a sweep has occurred (number of alleles involved in sweep, gini simpson index,
shannon index, frequency of most frequent allele).





